[ms-sysmon-events-wineventlog]
search = sourcetype="XmlWinEventLog:Microsoft-Windows-Sysmon/Operational" OR source="WinEventLog:Microsoft-Windows-Sysmon/Operational" OR source="XmlWinEventLog:Microsoft-Windows-Sysmon/Operational"
priority = 10

[ms-sysmon-events]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events*")

[ms-sysmon-process-created]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:processcreated") EventCode="1" ParentProcessGuid ParentImage

[ms-sysmon-file-ctime-changed]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:filectimechanged") EventCode="2" TargetFilename CreationUtcTime

[ms-sysmon-network-connect]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:networkconnect") EventCode="3" Initiated SourceIsIpv6 DestinationIsIpv6 DestinationIp

[ms-sysmon-state-changed]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:statechanged") EventCode="4" State Version SchemaVersion

[ms-sysmon-process-terminated]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:processterminated") EventCode="5" ProcessGuid Image

[ms-sysmon-driver-loaded]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:driverloaded") EventCode="6" ImageLoaded Signed Signature SignatureStatus

[ms-sysmon-image-loaded]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:imageloaded") EventCode="7" ProcessGuid ImageLoaded SignatureStatus Signed Signature

[ms-sysmon-create-remote-thread]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:createremotethread") EventCode="8" SourceImage StartAddress StartModule TargetProcessGuid

[ms-sysmon-raw-access-read]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:rawaccessread") EventCode="9" Device

[ms-sysmon-process-access]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:processaccess") EventCode="10" TargetProcessGuid TargetImage GrantedAccess CallTrace

[ms-sysmon-file-created]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:filecreated") EventCode="11" TargetFilename CreationUtcTime

[ms-sysmon-registry-create-delete]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:registrycreatedel") EventCode="12" TargetObject

[ms-sysmon-registryvalueset]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:registryvalueset") EventCode="13" TargetObject

[ms-sysmon-registryrename]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:registryrename") EventCode="14" TargetObject

[ms-sysmon-file-stream-created]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:filecreatestream") EventCode="15" TargetFilename CreationUtcTime Hash

[ms-sysmon-configuration-changed]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:configchange") EventCode="16" Configuration ConfigurationFileHash

[ms-sysmon-pipe]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:pipecreated" OR sourcetype="pipe:connected") EventCode="17" OR EventCode="18" PipeName

[ms-sysmon-wmi]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:wmi*") (EventCode="19" OR EventCode="20" OR EventCode="21") EventType Operation

[ms-sysmon-dns-query]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:dnsquery") EventCode="22" QueryName QueryStatus

[ms-sysmon-error]
search = (eventtype=ms-sysmon-events-wineventlog OR sourcetype="sysmon:events:error") EventCode="255" Error

#----


#[ms-sysmon-network]
#search = eventtype=ms-sysmon-network-connect

[ms-sysmon-process]
search = eventtype IN ("ms-sysmon-process-created", "ms-sysmon-process-terminated", "ms-sysmon-create-remote-thread", "ms-sysmon-process-access", "ms-sysmon-pipe")
#search = sourcetype="XmlWinEventLog:Microsoft-Windows-Sysmon/Operational" (EventCode="1" OR EventCode="5" OR EventCode="6" OR EventCode="8" OR EventCode="9" OR EventCode="10" OR EventCode="15" OR EventCode="17" OR EventCode="18")

[ms-sysmon-filemod]
search = eventtype IN ("ms-sysmon-file-created", "ms-sysmon-file-ctime-changed", "ms-sysmon-file-stream-created")

[ms-sysmon-regmod]
search = eventtype IN ("ms-sysmon-registry-create-delete", "ms-sysmon-registryvalueset", "ms-sysmon-registryrename")

[ms-sysmon-state]
search = eventtype IN ("ms-sysmon-configuration-changed", "ms-sysmon-error")
